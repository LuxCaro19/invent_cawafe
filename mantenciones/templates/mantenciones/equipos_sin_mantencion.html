{% extends 'base.html' %}
{% block content %}

<h2 class="mb-4">Equipos sin mantención registrada</h2>

<form method="post">
  {% csrf_token %}
  <div class="table-responsive">
    <table class="table table-striped table-bordered">
      <thead class="table-secondary">
        <tr>
          <th><input type="checkbox" id="check-todo"></th>
          <th>Etiqueta</th>
          <th>Tipo</th>
          <th>Estado</th>
          <th>Fecha de compra</th>
        </tr>
      </thead>
      <tbody>
        {% for equipo in equipos %}
          <tr>
            <td><input type="checkbox" name="equipos" value="{{ equipo.id }}"></td>
            <td>{{ equipo.etiqueta }}</td>
            <td>{{ equipo.modelo.tipo }}</td>
            <td>{{ equipo.estado.nombre }}</td>
            <td>{{ equipo.fecha_de_compra|default:"-" }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="mt-3 text-end">
    <a href="{% url 'lista_mantenciones' %}" class="btn btn-outline-secondary">Cancelar</a>
    <button type="submit" class="btn btn-primary">Crear mantención para seleccionados</button>
  </div>
</form>

<script>
document.getElementById("check-todo")?.addEventListener("click", function() {
  const estado = this.checked;
  document.querySelectorAll("input[name='equipos']").forEach(cb => cb.checked = estado);
});
</script>

{% endblock %}
